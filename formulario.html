<!DOCTYPE html>
<html lang="es">

<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CaucaTours - Formulario</title>
    <link rel="stylesheet" href="css/estilo.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
       
    </style>
    <script>
        let logoBase64 = null;

        async function cargarLogo() {
            const response = await fetch('img/LogoTurismo.png');
            if (!response.ok) {
                console.warn("No se pudo cargar el logo.");
                return;
            }
            const blob = await response.blob();
            const reader = new FileReader();
            reader.onloadend = () => {
                logoBase64 = reader.result;
            };
            reader.readAsDataURL(blob);
        }

        cargarLogo();
    </script>
</head>

<body>
    <header>
        <nav>
            <ul>
                <img src="img/LogoTurismo.png" alt="">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="galeria.html">Galer√≠a de Viajes</a></li>
                <li><a href="formulario.html">Formulario</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li><a href="EvolucionSistemas.html">Investigacion</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="main-container">
            <h1>Formulario de Reserva:</h1>
            <form id="reservaFormulario">
                <div class="form-grupo">
                    <label for="nombre">Nombre Completo:</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-grupo">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-grupo">
                    <label for="destino">Destino de Inter√©s:</label>
                    <input type="text" id="destino" name="destino" required>
                </div>
                <div class="form-grupo">
                    <label for="fecha">Fecha de Viaje:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>
                <div class="botones">
                    <button type="button" onclick="generarVistaPrevia()">Vista/PDF</button>
                </div>
            </form>

            <iframe id="vistaPrevia"></iframe>

            <div class="contacto-seccion">
                <div class="contacto-header">
                    <h2 style="color: black;">Buzon de Sugerencias</h2>
                    <p style="color: black;">Gestiona diferentes viajes o dejanos tus diferetes opiniones...</p>
                </div>
                <div class="contacto-form-container">
                    <form class="contacto-form">
                        <label for="mensaje">Tu mensajeüì©:</label>
                        <textarea id="mensaje" placeholder="Escribe aqu√≠ tu idea o comentario..."></textarea>
                        <button type="submit" class="boton-enviar">Enviar Mensaje</button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; P√°gina Web 2025 Turismo-CaucaTours.</p>
    </footer>

    <script>
        async function crearPDF() {
            const nombre = document.getElementById('nombre').value;
            const email = document.getElementById('email').value;
            const destino = document.getElementById('destino').value;
            const fecha = document.getElementById('fecha').value;

            if (!nombre || !email || !destino || !fecha) {
                alert("Por favor completa todos los campos.");
                return null;
            }

            const {
                jsPDF
            } = window.jspdf;
            const doc = new jsPDF();

            const today = new Date();
            const dia = String(today.getDate()).padStart(2, '0');
            const mes = String(today.getMonth() + 1).padStart(2, '0');
            const anio = today.getFullYear().toString().substr(-2);
            const fechaActual = `Fecha de solicitud: ${dia}-${mes}-${anio}`;

            doc.setFontSize(18);
            doc.text("CaucaTours - Carta de Reserva", 20, 40);

            doc.setFontSize(12);
            doc.text(fechaActual, 20, 50);
            doc.setFontSize(10);

            if (logoBase64) {
                doc.addImage(logoBase64, 'PNG', 10, 10, 50, 30);
            } else {
                console.warn("Logo no disponible, se generar√° el PDF sin √©l.");
            }

            const texto =
                `Se√±or/a ${nombre},

Nos complace informarle que hemos recibido su solicitud de reserva para nuestros servicios de Turismo.

Detalles de la reserva:
- Correo de contacto: ${email}
- Destino de inter√©s: ${destino}
- Fecha de viaje: ${fecha}

El equipo administrativo se pondr√° en contacto con usted para confirmar los detalles y ofrecerle la mejor experiencia.

Atentamente:
Equipo Tur√≠stico - CaucaTours.`;

            const lineas = doc.splitTextToSize(texto, 170);
            doc.text(lineas, 20, 70);

            return doc;
        }

        async function generarVistaPrevia() {
            const doc = await crearPDF();
            if (!doc) return;

            const vistaPrevia = document.getElementById('vistaPrevia');
            const blob = doc.output('blob');
            const url = URL.createObjectURL(blob);
            vistaPrevia.src = url;
            vistaPrevia.style.display = 'block';
        }
    </script>
</body>

</html>


